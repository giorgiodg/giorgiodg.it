---
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import { WORK } from "@consts";
import { SKILLS_LIST } from "@consts";
import Link from "@components/Link.astro";
import { getCollection } from "astro:content";

const collection = (await getCollection("work")).sort(
  (a, b) => b.data.position - a.data.position
);

const work = await Promise.all(
  collection.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);
---

<PageLayout title={WORK.TITLE} description={WORK.DESCRIPTION}>
  <Container>
    <h2 class="font-extrabold pt-16">{WORK.TITLE}</h2>
    <div class="space-y-16 pt-8">
      <section>
        <h3 class="font-semibold">Skills</h3>
        <article class="flex flex-col">
          {
            Object.entries(SKILLS_LIST).map(([group, items]) => (
              <div>
                <h4 class="font-serif">{group}</h4>
                <p>{items.join(", ")}</p>
              </div>
            ))
          }
        </article>
      </section>
      <section>
        <h3 class="font-semibold pb-2">Testimonials</h3>
         <article class="flex flex-col">
          {
            work.map((entry) => (
                <h4 class="font-serif">
                  {entry.data.role}
                </h4>
                  <entry.Content />
            ))
          }
        </article>
      
      <div class="pt-4">
      See more testimonials on my&nbsp;
      <Link
        href="https://www.linkedin.com/in/giorgiodellegrottaglie/"
        external
        aria-label="Linkedin"
        data-event="cta-click"
        data-properties='{"buttonText":"LinkedIn","source":"testimonials"}'
        >LinkedIn profile</Link
      >
    </div></section>
  </Container>
</PageLayout>
